/* Build from script.source.js â€” execute npm run build:assets */
(()=>{function We(){return typeof window=="undefined"?!1:!!window.__DASHBOARD_DEBUG__}function A(e,...o){if(We()){if(typeof e=="function"){try{const t=e();Array.isArray(t)?console.log(...t):console.log(t)}catch(t){console.error("Debug log failure:",t)}return}console.log(e,...o)}}typeof window!="undefined"&&(window.debugLog=A,window.isDebugEnabled=We);const ne=".room-control[data-device-id], .control-card[data-device-id]",ae=".room-master-btn[data-device-ids]",V=new Map,U=new Set,ee=new Map;let xe=!1,le=null,N=null,J=null,he=!1;const Ye=["photo-varanda","photo-living","photo-piscina","photo-externo","photo-servico","photo-circulacao","photo-suitei","photo-suiteii","photo-suitemaster"],uo=[480,720,960,1440,1920,2560],mo=Ye.slice(0,3),fo=["images/icons/icon-tv.svg","images/icons/icon-htv.svg","images/icons/icon-musica.svg","images/icons/icon-curtain.svg","images/icons/icon-firetv.svg","images/icons/icon-conforto.svg","images/icons/ar-condicionado.svg","images/icons/icon-piscina.svg","images/icons/icon-telao-led.svg","images/icons/icon-small-light-off.svg","images/icons/icon-small-light-on.svg","images/icons/icon-small-smartglass-off.svg","images/icons/icon-small-smartglass-on.svg","images/icons/icon-small-shader-off.svg","images/icons/icon-small-shader-on.svg","images/icons/icon-small-tv-off.svg","images/icons/icon-small-tv-on.svg","images/icons/icon-small-telamovel-off.svg","images/icons/icon-small-telamovel-on.svg","images/icons/icon-ac-power.svg","images/icons/icon-ac-fan.svg","images/icons/icon-ac-cool.svg","images/icons/icon-ac-heat.svg","images/icons/icon-ac-auto.svg","images/icons/icon-ac-aleta-moving.svg","images/icons/icon-ac-aleta-parada.svg","images/icons/icon-ac-aleta-alta.svg","images/icons/icon-ac-aleta-baixa.svg","images/icons/icon-rotatephone.svg","images/icons/icon-settings.svg","images/icons/icon-home.svg","images/icons/back-button.svg","images/icons/Eletrize.svg","images/icons/Fullscreen.svg","images/icons/icon-limpar.svg","images/icons/icon-mouse.svg","images/icons/Instagram.svg","images/icons/whatsapp.svg","images/icons/icon-volume.svg","images/icons/icon-mute.svg","images/icons/icon-next-track.svg","images/icons/icon-previous-track.svg","images/icons/icon-play.svg","images/icons/icon-pause.svg","images/icons/icon-stop.svg","images/icons/Encerrar-expediente.svg","images/icons/iniciar-expediente.svg","images/icons/icon-scenes.svg","images/icons/pageselector.svg"];const B=(()=>{const e={critical:new Set,background:new Set};function o(n,{priority:a="background"}={}){if(!n)return;e[a==="critical"?"critical":"background"].add(n)}function t(n,{weight:a=0,offset:s=0}={}){if(typeof window=="undefined")return Promise.resolve();const r=Array.from(e[n]||[]);return r.length?new Promise(i=>{let l=0;const u=r.length,h=p=>{if(l+=1,a>0){const y=s+Math.min(a,Math.round(l/u*a));E(y,`Pr\xE9-carregando m\xEDdia (${l}/${u})`)}l===u&&i()};r.forEach(p=>{const y=new Image;y.decoding="async",y.loading="eager",y.onload=y.onerror=()=>h(p),y.src=p})}):Promise.resolve()}return{add:o,startQueue:t}})();Ye.forEach(e=>{uo.forEach(o=>{const t=mo.includes(e)&&o<=720?"critical":"background";B.add(`images/optimized/${e}-${o}.webp`,{priority:t})}),B.add(`images/Images/${e}.jpg`,{priority:"background"})});B.add("images/pwa/app-icon-420.webp",{priority:"critical"});B.add("images/pwa/app-icon-192.png",{priority:"background"});B.add("images/pwa/app-icon-512-transparent.png",{priority:"background"});fo.forEach(e=>B.add(e,{priority:"background"}));let Xe=!1,oe=null;typeof window!="undefined"&&(oe=B.startQueue("critical",{weight:30,offset:0}).catch(e=>{console.warn("Falha ao pr\xE9-carregar m\xEDdia cr\xEDtica",e)}).finally(()=>{Xe=!0,B.startQueue("background",{weight:15,offset:30}).catch(e=>console.warn("Falha ao pr\xE9-carregar m\xEDdia adicional",e))}),window.__assetPreloadPromise=oe,window.queueAssetForPreload=(e,o)=>B.add(e,{priority:o}));function Ke(){var o;if(typeof window=="undefined")return!1;const e=typeof window.matchMedia=="function"?window.matchMedia("(display-mode: standalone)"):null;return!!(e&&e.matches||((o=window.navigator)==null?void 0:o.standalone)===!0)}async function Ve(){if(!(typeof navigator=="undefined"||!navigator.storage||typeof navigator.storage.persist!="function"))try{if(await navigator.storage.persisted())return;await navigator.storage.persist()}catch(e){console.warn("N\xE3o foi poss\xEDvel garantir armazenamento persistente:",e)}}const go=(()=>{let e=!1;function o(){return typeof document!="undefined"&&typeof document.documentElement.requestFullscreen=="function"}function t(){var a;e||!o()||(e=!0,document.documentElement.requestFullscreen({navigationUI:"hide"}).catch(s=>{console.warn("N\xE3o foi poss\xEDvel entrar em tela cheia automaticamente",s)}),(a=screen==null?void 0:screen.orientation)!=null&&a.lock&&screen.orientation.lock("landscape").catch(()=>{}))}function n(){if(!Ke()||!o())return;const a=()=>{document.removeEventListener("click",a),document.removeEventListener("touchend",a),t()};document.addEventListener("click",a,{once:!0}),document.addEventListener("touchend",a,{once:!0})}return typeof window!="undefined"&&window.addEventListener("DOMContentLoaded",n),{enterFullscreen:t}})();typeof window!="undefined"&&(window.requestPersistentStorage=Ve,window.fullscreenManager=go,window.addEventListener("DOMContentLoaded",()=>{Ke()&&Ve()}));const po=["ambiente1-musica","ambiente2-musica","ambiente3-musica"];function Ae(e=window.location.hash){return po.some(o=>e.includes(o))}function I(e){const o=document.querySelector(".page.active");return o?o.querySelector(e):null}function ho(){const e=navigator.userAgent.toLowerCase(),o=/ipad/.test(e),t=window.screen.width,n=window.screen.height;return o&&(t===1024&&n===768||t===768&&n===1024)?(document.documentElement.dataset.device="ipad-mini-6",console.log("\xC3\xB0\xC5\xB8\xC2\x8D\xC5\xBD iPad Mini 6 detectado - aplicando fixes espec\xC3\u0192\xC2\xADficos",`Screen: ${t}x${n}`,`Inner: ${window.innerWidth}x${window.innerHeight}`,`DPR: ${window.devicePixelRatio}`),!0):!1}function vo(){const e=navigator.userAgent.toLowerCase(),o=/iphone/.test(e),t=/android/.test(e),n=window.innerWidth<768,a=/ipad|galaxy tab|sm-t/.test(e);return(o||t&&n)&&!a}function yo(){const e=navigator.userAgent.toLowerCase(),o=/ipad|iphone|mac os x/.test(e)&&navigator.maxTouchPoints>1,t=/android/.test(e);(o||t)&&(document.documentElement.dataset.device="mobile",console.log(`\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xB1 Dispositivo mobile detectado (${o?"Apple":"Android"})`))}function wo(){return window.location.pathname.includes("ambiente1-tv")||window.location.hash.includes("ambiente1-tv")||window.location.pathname.includes("ambiente1-htv")||window.location.hash.includes("ambiente1-htv")}function Ne(){let e=document.getElementById("orientation-overlay");if(!e&&(e=document.createElement("div"),e.id="orientation-overlay",e.innerHTML=`
      <div class="orientation-overlay-content">
        <img src="images/icons/icon-rotatephone.svg" alt="Rotacione o dispositivo" class="orientation-icon">
        <p class="orientation-message">Rotacione o dispositivo</p>
      </div>
    `,document.body.appendChild(e),!document.getElementById("orientation-overlay-styles"))){const o=document.createElement("style");o.id="orientation-overlay-styles",o.innerHTML=`
        #orientation-overlay {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.95);
          backdrop-filter: blur(10px);
          -webkit-backdrop-filter: blur(10px);
          z-index: 10000;
          align-items: center;
          justify-content: center;
        }

        #orientation-overlay.active {
          display: flex;
        }

        .orientation-overlay-content {
          text-align: center;
          color: #fff;
        }

        .orientation-icon {
          width: 120px;
          height: 120px;
          margin-bottom: 20px;
          animation: rotate 2s infinite;
          filter: brightness(0) invert(1);
        }

        .orientation-message {
          font-size: 24px;
          font-weight: 600;
          letter-spacing: 0.5px;
          margin: 0;
          font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }

        @keyframes rotate {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }

        @media (max-width: 480px) {
          .orientation-icon {
            width: 80px;
            height: 80px;
          }

          .orientation-message {
            font-size: 18px;
          }
        }
      `,document.head.appendChild(o)}return e}function Pe(){const e=vo(),o=window.innerWidth>window.innerHeight,t=wo();e&&o&&t?(Ne().classList.add("active"),document.documentElement.dataset.layoutState="mobile-blocked",console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xB5 Celular em landscape no controle remoto - bloqueado")):(Ne().classList.remove("active"),document.documentElement.dataset.layoutState="default")}ho();yo();Pe();window.addEventListener("orientationchange",Pe);window.addEventListener("resize",Pe);const P=["231","232","233","234","259","260","261","262","263","256","257","258","15"];const Z={HEALTH_CHECK_TIMEOUT:5e3,FETCH_TIMEOUT_PER_ATTEMPT:15e3,MAX_RETRY_ATTEMPTS:3,RETRY_DELAY_BASE:1e3,RETRY_DELAY_MAX:5e3};function Eo(e){const o="images/icons/icon-small-light-on.svg",t="images/icons/icon-small-light-off.svg",n=e.querySelector(".room-control-icon, .control-icon"),s=(e.dataset.state||"off")==="off"?"on":"off",r=e.dataset.deviceId;r&&(_.set(r,Date.now()),e.dataset.state=s,n&&(n.src=s==="on"?o:t),G(r,s),console.log(`Enviando comando ${s} para dispositivo ${r}`),b(r,s==="on"?"on":"off").then(()=>{console.log(`\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Comando ${s} enviado com sucesso para dispositivo ${r}`)}).catch(i=>{console.error(`\xC3\xA2\xC2\x9D\xC5\u2019 Erro ao enviar comando para dispositivo ${r}:`,i);const l=s==="on"?"off":"on";e.dataset.state=l,n&&(n.src=l==="on"?o:t),G(r,l)}))}function bo(e,o){const t=e.dataset.deviceId;if(!o||!t)return;const n=e.closest(".piscina-control-tile");if(!n)return;const a=n.querySelector(".piscina-control-btn--on"),s=n.querySelector(".piscina-control-btn--off");a&&a.classList.remove("active"),s&&s.classList.remove("active"),o==="on"&&a?a.classList.add("active"):o==="off"&&s&&s.classList.add("active"),_.set(t,Date.now()),console.log(`Enviando comando ${o} para dispositivo piscina ${t}`),b(t,o).then(()=>{console.log(`\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Comando ${o} enviado com sucesso para dispositivo ${t}`)}).catch(r=>{console.error(`\xC3\xA2\xC2\x9D\xC5\u2019 Erro ao enviar comando para dispositivo ${t}:`,r),o==="on"&&a?a.classList.remove("active"):o==="off"&&s&&s.classList.remove("active")})}let So="off";function we(e){So=e;const o=document.querySelector(".tv-btn--power-on"),t=document.querySelector(".tv-btn--power-off"),n=document.querySelectorAll(".tv-volume-canais-wrapper, .tv-commands-grid, .tv-directional-pad, .tv-numpad, .tv-logo-section"),a=document.querySelectorAll(".tv-section-title");e==="on"?(o==null||o.classList.add("active"),t==null||t.classList.remove("active"),n.forEach(s=>{s.style.opacity="1",s.style.pointerEvents="auto"}),a.forEach(s=>{s.style.opacity="1"}),console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xBA TV LIGADA - Controles vis\xC3\u0192\xC2\xADveis")):(t==null||t.classList.add("active"),o==null||o.classList.remove("active"),n.forEach(s=>{s.style.opacity="0.15",s.style.pointerEvents="none"}),a.forEach(s=>{s.style.opacity="0.2"}),console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xBA TV DESLIGADA - Controles desabilitados"))}function Io(e,o){const t=e.dataset.deviceId;!o||!t||(o==="on"?we("on"):o==="off"&&we("off"),e.style.transform="scale(0.92)",e.style.background="rgba(255, 255, 255, 0.15)",e.style.borderColor="rgba(255, 255, 255, 0.3)",setTimeout(()=>{e.style.transform="",e.style.background="",e.style.borderColor=""},200),_.set(t,Date.now()),console.log(`\u{1F4FA} Enviando comando ${o} para dispositivo ${t}`),b(t,o).then(()=>{console.log(`\u2705 Comando TV ${o} enviado com sucesso para dispositivo ${t}`)}).catch(n=>{console.error(`\u274C Erro ao enviar comando TV para dispositivo ${t}:`,n)}))}function Co(){console.log("\u{1F3AC} Macro HTV: Ligando TV e Receiver, depois setando input SAT/CBL..."),b("111","on").then(()=>(console.log("\u2705 TV ligada"),b("15","on"))).then(()=>(console.log("\u2705 Receiver ligado"),b("15","setInputSource","SAT/CBL"))).then(()=>{console.log("\u2705 Input SAT/CBL selecionado no Receiver")}).catch(t=>{console.error("\u274C Erro na macro HTV:",t)})}function To(){console.log("\u{1F3AC} Macro HTV: Desligando TV e Receiver..."),Promise.all([b("111","off"),b("15","off")]).then(()=>{console.log("\u2705 TV e Receiver desligados")}).catch(t=>{console.error("\u274C Erro ao desligar TV/Receiver:",t)})}function Ao(){console.log("\u{1F3AC} Macro TV: Ligando TV e Receiver, depois setando input TV..."),b("111","on").then(()=>(console.log("\u2705 TV ligada"),b("15","on"))).then(()=>(console.log("\u2705 Receiver ligado"),b("15","setInputSource","TV"))).then(()=>{console.log("\u2705 Input TV selecionado no Receiver")}).catch(t=>{console.error("\u274C Erro na macro TV:",t)})}function Po(){console.log("\u{1F3AC} Macro TV: Desligando TV e Receiver..."),Promise.all([b("111","off"),b("15","off")]).then(()=>{console.log("\u2705 TV e Receiver desligados")}).catch(t=>{console.error("\u274C Erro ao desligar TV/Receiver:",t)})}function Do(){console.log("\u{1F3AC} Macro Fire TV: Selecionando HDMI 2 e setando Receiver para BD..."),b("111","hdmi2").then(()=>(console.log("\u2705 HDMI 2 selecionado na TV"),b("15","setInputSource","BD"))).then(()=>{console.log("\u2705 Input BD selecionado no Receiver")}).catch(t=>{console.error("\u274C Erro na macro Fire TV:",t)})}function Be(){const e=document.getElementById("tv-volume-slider"),o=document.getElementById("tv-volume-display"),t="15";if(!e||!o){console.log("\xC3\xA2\xC5\xA1\xC2\xA0\xC3\xAF\xC2\xB8\xC2\x8F Slider ou display n\xC3\u0192\xC2\xA3o encontrado");return}console.log("\xC3\xB0\xC5\xB8\xC5\xBD\xC5\xA1\xC3\xAF\xC2\xB8\xC2\x8F Inicializando slider de volume do Denon AVR"),e.dataset.deviceId=t;const n=e.cloneNode(!0);e.parentNode.replaceChild(n,e);const a=document.getElementById("tv-volume-slider");Je(),a.addEventListener("input",s=>{const r=s.target.value,i=s.target.max||100,l=r/i*100;o.textContent=r,a.style.setProperty("--volume-progress",l+"%"),console.log(`\xC3\xB0\xC5\xB8\xC5\xBD\xC5\xA1\xC3\xAF\xC2\xB8\xC2\x8F Volume display atualizado: ${r} (${l.toFixed(1)}%)`)}),a.addEventListener("change",s=>{const r=s.target.value;console.log(`\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC5\xA0 Volume alterado para: ${r} - enviando para Denon AVR`),b(t,"setVolume",r).then(()=>{console.log(`\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Volume do Denon definido para ${r}`)}).catch(i=>{console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Erro ao definir volume do Denon:",i)})}),console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Slider de volume do Denon AVR inicializado com sucesso")}async function Je(){var a,s,r,i,l,u,h;const o=document.getElementById("tv-volume-slider"),t=document.getElementById("tv-volume-display"),n=typeof I=="function"?I("#music-volume-slider"):document.querySelector("#music-volume-slider");try{const p=M?`${q}?devices=15`:null;if(!p){console.log("\xC3\xA2\xC2\x9D\xC5\u2019 N\xC3\u0192\xC2\xA3o \xC3\u0192\xC2\xA9 poss\xC3\u0192\xC2\xADvel buscar volume em desenvolvimento");return}const y=await fetch(p);if(!y.ok)throw new Error(`Polling failed: ${y.status}`);const w=await y.json();let C=null,d=null;if(w.devices&&w.devices[15]){const c=w.devices[15];C=(s=(a=c.volume)!=null?a:c.level)!=null?s:c.attributes&&c.attributes.volume,d=Ee(c)}else if(Array.isArray(w.data)){const c=w.data.find(m=>String(m.id)==="15");if(c){if(c.attributes)if(Array.isArray(c.attributes)){const m=c.attributes.find(f=>(f==null?void 0:f.name)==="volume");C=(l=(i=(r=m==null?void 0:m.currentValue)!=null?r:m==null?void 0:m.value)!=null?i:c.volume)!=null?l:C}else typeof c.attributes=="object"&&(C=(h=(u=c.attributes.volume)!=null?u:c.volume)!=null?h:C);else c.volume!==void 0&&(C=c.volume);d=Ee(c)}}if(C!=null){const c=parseInt(C,10);if(o){const m=parseInt(o.max||"100",10),f=c/m*100;o.value=c,o.style.setProperty("--volume-progress",f+"%")}if(t&&(t.textContent=c),n){const m=parseInt(n.max||"100",10),f=c/m*100;n.value=c,n.style.setProperty("--volume-percent",f+"%")}console.log("[Denon] Volume atualizado:",c)}d&&De(d)}catch(p){console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Erro ao buscar volume do Denon:",p)}}function Lo(e){const o=document.getElementById("tv-volume-slider"),t=document.getElementById("tv-volume-display"),n=typeof I=="function"?I("#music-volume-slider"):document.querySelector("#music-volume-slider");if(A(()=>["updateDenonVolumeUI chamada",{volume:e}]),!o&&!n){A(()=>"updateDenonVolumeUI: nenhum controle encontrado na p\xE1gina");return}const a=parseInt(e,10);A(()=>["updateDenonVolumeUI: estado atual",{recebido:e,convertido:a,tvSlider:o?o.value:"n/a",musicSlider:n?n.value:"n/a"}]);const s=_.get("15");if(s&&Date.now()-s<ie){A(()=>"updateDenonVolumeUI: comando manual recente, ignorando polling");return}let r=!1;if(o){const i=parseInt(o.value,10),l=o.max||100,u=a/l*100;i!==a&&(o.value=a,o.style.setProperty("--volume-progress",u+"%"),r=!0),t&&(t.textContent=a)}if(n){const i=parseInt(n.value,10),l=n.max||100,u=a/l*100;i!==a&&(n.value=a,n.style.setProperty("--volume-percent",u+"%"),typeof updateVolumeBar=="function"&&updateVolumeBar(),r=!0)}r&&A(()=>["updateDenonVolumeUI: volume sincronizado",{volumeValue:a}])}function te(e){if(e==null)return null;const o=String(e).trim().toLowerCase();return["on","1","true","online"].includes(o)?"on":["off","0","false","offline","standby"].includes(o)?"off":null}function Ee(e){var n;if(!e||typeof e!="object")return null;const o=[e.switch,e.state,e.power,e.status];for(const a of o){const s=te(a);if(s)return s}const t=e.attributes;if(Array.isArray(t))for(const a of t){if(!a)continue;const s=String(a.name||a.attribute||"").toLowerCase();if(s&&["switch","power","status","state"].includes(s)){const r=te((n=a.currentValue)!=null?n:a.value);if(r)return r}}else if(t&&typeof t=="object"){const a=["switch","power","status","state"];for(const s of a)if(s in t){const r=te(t[s]);if(r)return r}}return null}function De(e){const o=te(e);if(!o)return;if(typeof _!="undefined"){const n=_.get("15");if(n&&Date.now()-n<ie){console.log("[Denon] Ignorando sincronizacao de power por comando recente");return}}const t=o==="on";window.musicPlayerUI=window.musicPlayerUI||{},window.musicPlayerUI.currentPowerState=o,!(window.musicPlayerUI&&typeof window.musicPlayerUI.isPowerOn=="function"&&window.musicPlayerUI.isPowerOn()===t)&&window.musicPlayerUI&&typeof window.musicPlayerUI.setPower=="function"&&window.musicPlayerUI.setPower(t)}document.addEventListener("DOMContentLoaded",()=>{we("off"),Be(),window.addEventListener("hashchange",()=>{setTimeout(()=>{Be()},100)}),window.addEventListener("hashchange",()=>{Ae()?setTimeout(()=>{co(),$e(),io()},300):Te()})});function Ze(e,o){const t="images/icons/icon-small-light-on.svg",n="images/icons/icon-small-light-off.svg",a=o==="on"?"on":"off";e.dataset.state=a;const s=e.querySelector(".room-control-icon, .control-icon");if(s){const r=a==="on"?t:n;console.log(`\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC2\xA7 setRoomControlUI: Atualizando imagem ${s.src} \xC3\xA2\xE2\u20AC\xA0\xE2\u20AC\u2122 ${r} (estado: ${o})`),s.src=r}else console.warn(`\xC3\xA2\xC5\xA1\xC2\xA0\xC3\xAF\xC2\xB8\xC2\x8F setRoomControlUI: Imagem n\xC3\u0192\xC2\xA3o encontrada para elemento com classes: ${e.className}`),console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC2\x8D Elementos filhos:",Array.from(e.children).map(r=>r.className))}function Le(e){return`deviceState:${e}`}function k(e){if(ee.has(e))return ee.get(e);try{const o=Le(e),t=localStorage.getItem(o);return t!=null&&ee.set(e,t),t}catch(o){return A(()=>["getStoredState fallback",e,o]),null}}function G(e,o){ee.set(e,o);try{const t=Le(e);localStorage.setItem(t,o)}catch(t){console.warn(`Erro ao salvar estado ${e}:`,t)}}function be(e){if(!e||!e.dataset)return!1;const o=e.dataset.deviceId;if(!o)return!1;let t=V.get(o);return t||(t=new Set,V.set(o,t)),t.has(e)?!1:(t.add(e),!0)}function qe(e){if(!e||!e.dataset)return!1;const o=e.dataset.deviceId;if(!o)return!1;const t=V.get(o);if(!t)return!1;const n=t.delete(e);return t.size===0&&V.delete(o),n}function Se(e){return!e||U.has(e)?!1:(U.add(e),!0)}function Ue(e){return e?U.delete(e):!1}function Mo(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;let o=!1;return e.matches&&e.matches(ne)&&(o=be(e)||o),e.matches&&e.matches(ae)&&(o=Se(e)||o),typeof e.querySelectorAll=="function"&&(e.querySelectorAll(ne).forEach(function(t){o=be(t)||o}),e.querySelectorAll(ae).forEach(function(t){o=Se(t)||o})),o}function _o(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;let o=!1;return e.matches&&e.matches(ne)&&(o=qe(e)||o),e.matches&&e.matches(ae)&&(o=Ue(e)||o),typeof e.querySelectorAll=="function"&&(e.querySelectorAll(ne).forEach(function(t){o=qe(t)||o}),e.querySelectorAll(ae).forEach(function(t){o=Ue(t)||o})),o}function Qe(e){const o=e||{},t=o.root&&typeof o.root.querySelectorAll=="function"?o.root:document,n=!!o.force;xe&&!n||(t.querySelectorAll(ne).forEach(function(a){be(a)}),t.querySelectorAll(ae).forEach(function(a){Se(a)}),xe=!0)}function ge(){V.forEach(function(e,o){e.forEach(function(t){t.isConnected||e.delete(t)}),e.size===0&&V.delete(o)}),U.forEach(function(e){e.isConnected||U.delete(e)})}function Ie(e){if(e&&(he=!0),J===null){var o=function(){J=null;var t=he;he=!1,re(t)};if(typeof window!="undefined"){if(typeof window.requestIdleCallback=="function"){J=window.requestIdleCallback(o,{timeout:120});return}if(typeof window.requestAnimationFrame=="function"){J=window.requestAnimationFrame(function(){o()});return}}J=setTimeout(o,32)}}function Oo(){A(()=>["initRoomPage: start"]);const e=document.getElementById("spa-root")||document;Qe({root:e,force:!0}),ge(),re(!0);try{(window.location.hash||"").replace("#","")==="ambiente5"&&document.querySelectorAll(".room-control-label").forEach(function(n){(n.textContent||"").trim().toLowerCase().startsWith("ilumin")&&(n.textContent="Bar")})}catch(t){A(()=>["initRoomPage rename fallback",t])}const o=function(){se(!0)};typeof window.requestIdleCallback=="function"?window.requestIdleCallback(o,{timeout:200}):setTimeout(o,50)}window.normalizeAccents=function(o){try{const t=new Map([["Escrit\xC3\xAF\xC2\xBF\xC2\xBD\xC3\xAF\xC2\xBF\xC2\xBDrio","Escrit\xC3\u0192\xC2\xB3rio"],["Programa\xC3\xAF\xC2\xBF\xC2\xBD\xC3\xAF\xC2\xBF\xC2\xBD\xC3\u2021\xC5\u201Co","Programa\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xA3o"],["Recep\xC3\xAF\xC2\xBF\xC2\xBD\xC3\xAF\xC2\xBF\xC2\xBD\xC3\u2021\xC5\u201Co","Recep\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xA3o"],["Refeit\xC3\xAF\xC2\xBF\xC2\xBD\xC3\xAF\xC2\xBF\xC2\xBDrio","Refeit\xC3\u0192\xC2\xB3rio"],["Funcion\xC3\u2021\xC2\xADrios","Funcion\xC3\u0192\xC2\xA1rios"],["Ilumina\xC3\xAF\xC2\xBF\xC2\xBD\xC3\xAF\xC2\xBF\xC2\xBDo","Ilumina\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xA3o"],["Ilumina\xC3\xAF\xC2\xBF\xC2\xBD\xC3\xAF\xC2\xBF\xC2\xBD\xC3\u2021\xC5\u201Co","Ilumina\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xA3o"],["Pain\xC3\u2021\xC2\xB8is","Pain\xC3\u0192\xC2\xA9is"],["Arm\xC3\u2021\xC2\xADrio","Arm\xC3\u0192\xC2\xA1rio"],["Ambient\xC3\u2021\xC5\u201Co","Ambiente"]]);(o||document).querySelectorAll(".page-title, .room-control-label, .room-card span").forEach(s=>{const r=s.textContent||"";let i=r;t.forEach((l,u)=>{i.includes(u)&&(i=i.replaceAll(u,l))}),i!==r&&(s.textContent=i)})}catch{}};async function Ro(){if(!window.confirm("Deseja realmente limpar todo o cache do aplicativo? Isso ira recarregar a pagina.")){console.log("Limpeza manual de cache cancelada pelo usuario.");return}console.log("Iniciando limpeza manual de cache."),typeof Fe=="function"&&void 0;const o=["hubitat_host","hubitat_token"],t={};try{o.forEach(n=>{const a=localStorage.getItem(n);a!==null&&(t[n]=a)}),localStorage.clear(),Object.keys(t).forEach(n=>{localStorage.setItem(n,t[n])})}catch(n){console.warn("Erro ao limpar localStorage:",n)}try{sessionStorage.clear()}catch(n){console.warn("Erro ao limpar sessionStorage:",n)}if("caches"in window)try{const n=await caches.keys();await Promise.all(n.map(a=>caches.delete(a)))}catch(n){console.warn("Erro ao limpar caches do navegador:",n)}if(navigator.serviceWorker&&navigator.serviceWorker.getRegistrations)try{const n=await navigator.serviceWorker.getRegistrations();await Promise.all(n.map(a=>a.unregister()))}catch(n){console.warn("Erro ao remover service workers:",n)}try{const n=Date.now(),a=n.toString()+"_"+Math.random().toString(36).substring(2,10);localStorage.setItem("last_cache_clear",n.toString()),localStorage.setItem("app_cache_version",a)}catch(n){console.warn("Erro ao atualizar metadados de cache:",n)}typeof Fe=="function"&&void 0,setTimeout(()=>{window.location.reload()},400)}window.brutalCacheClear=Ro;const $o=!["localhost","127.0.0.1","::1"].includes(location.hostname),M=!0;console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC2\x8D DEBUG PRODU\xC3\u0192\xE2\u20AC\xA1\xC3\u0192\xC6\u2019O (FOR\xC3\u0192\xE2\u20AC\xA1ADO):",{hostname:location.hostname,isProductionOriginal:$o,isProduction:M,isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)});const j=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),eo=/iPad|iPhone|iPod/.test(navigator.userAgent),Me=!0,ve="1.0.0";(function(){if(0)try{var e,o,t;if(e&&e!==ve){var n,a;for(var s;s<localStorage.length;s++)var r}}catch(i){}})();function Ce(){if(Me&&typeof console!="undefined"&&console.log)try{console.log.apply(console,arguments)}catch{}}function Fe(e,o){}Me||(window.console=window.console||{},window.console.log=function(){},window.console.error=function(){},window.console.warn=function(){});Me&&(Ce("=== DASHBOARD ELETRIZE DEBUG ==="),Ce("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC2\x8D isProduction:",M,"isMobile:",j));Ce("=== AMBIENTE DETECTADO ===",{isProduction:M,isMobile:j,isIOS:eo,userAgent:navigator.userAgent.substring(0,60)+"..."});const oo="/hubitat-proxy",q="/polling";window.musicPlayerUI=window.musicPlayerUI||{};const ko=!0,xo="https://cloud.hubitat.com/api/e45cb756-9028-44c2-8a00-e6fb3651856c/apps/15",Vo="1d9b367b-e4cd-4042-b726-718b759a82ef",No=`${xo}/devices`,Bo=new Set(["109","115","116"]);function to(e){return ko&&e!==void 0&&Bo.has(String(e))}const qo=/[\u00C3\u00C2\u00E2\uFFFD]/,Uo=[["\xE2\x80\x99","\xC3\xA2\xE2\u201A\xAC\xE2\u201E\xA2"],["\xE2\x80\x98","\xC3\xA2\xE2\u201A\xAC\xCB\u0153"],["\xE2\x80\x9C","\xC3\xA2\xE2\u201A\xAC\xC5\u201C"],["\xE2\x80\x9D","\xC3\xA2\xE2\u201A\xAC\xC2\x9D"],["\xE2\x80\x93","\xC3\xA2\xE2\u201A\xAC\xE2\u20AC\u0153"],["\xE2\x80\x94","\xC3\xA2\xE2\u201A\xAC\xE2\u20AC\x9D"],["\xE2\x80\xA6","\xC3\xA2\xE2\u201A\xAC\xC2\xA6"],["\xE2\x80\xA2","\xC3\xA2\xE2\u201A\xAC\xC2\xA2"],["\xC2\xBA","\xC3\u201A\xC2\xBA"],["\xC2\xAA","\xC3\u201A\xC2\xAA"],["\xC2\xB0","\xC3\u201A\xC2\xB0"],["\xC2\xA9","\xC3\u201A\xC2\xA9"],["\xC2\xAE","\xC3\u201A\xC2\xAE"]],ze=typeof TextDecoder!="undefined"?new TextDecoder("utf-8",{fatal:!1}):null;function Fo(e){return qo.test(e)}function zo(e){if(!ze)return null;const o=new Uint8Array(e.length);for(let t=0;t<e.length;t+=1){const n=e.charCodeAt(t);if(n>255)return null;o[t]=n}try{return ze.decode(o)}catch{return null}}function X(e){if(e==null)return e;let o=String(e);if(!o.trim())return o.trim();const t=o;if(o=o.trim(),Fo(o)){const n=zo(o);n&&n.trim()&&(o=n.trim())}return o=o.replace(/\u00C2\u00A0/g," ").replace(/\u00C2(?=[^\w\s])/g,"").replace(/\u00C2\s/g," ").replace(/\uFFFD/g,"").replace(/\s{2,}/g," ").replace(/\s+([!?.,;:])/g,"$1").replace(/([(\[{])\s+/g,"$1").replace(/\s+([\)\]}])/g,"$1"),Uo.forEach(([n,a])=>{o.includes(n)&&(o=o.split(n).join(a))}),o||t.trim()}function He(e){if(e==null)return null;const o=String(e).toLowerCase();return o==="playing"||o==="play"||o==="buffering"||o==="resume"||o==="run"||o==="start"||o==="on"?!0:o==="paused"||o==="pause"||o==="stopped"||o==="stop"||o==="idle"||o==="standby"||o==="off"?!1:null}typeof window.musicPlayerUI.currentPlaying!="boolean"&&(window.musicPlayerUI.currentPlaying=!1);function z(e){const o=document.createElement("div");o.className="error-modal",o.style.cssText=`
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        padding: 24px;
        max-width: 90vw;
        min-width: 320px;
        z-index: 10000;
        text-align: center;
    `,o.innerHTML=`
        <h3 style="margin-bottom: 12px; font-size: 1.4rem;">\xC3\xA2\xC2\x9D\xC5\u2019 Erro de Conex\xC3\u0192\xC2\xA3o</h3>
        <p style="margin-bottom: 20px; line-height: 1.5;">${e}</p>
        <button onclick="this.parentElement.remove()" style="
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        " onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 6px 20px rgba(231, 76, 60, 0.4)'" 
           onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none'">Fechar</button>
    `,document.body.appendChild(o),setTimeout(()=>{o.parentElement&&o.remove()},1e4)}async function Ho(e){console.warn("Fallback direto desativado. Usando apenas estados locais armazenados."),Array.isArray(e)||(e=typeof e=="string"?e.split(",").map(t=>t.trim()):[]);const o={};return e.forEach(t=>{const n=k(t)||"off";$(t,n,!0),o[t]={state:n,success:!1,error:"Direct polling disabled"}}),{timestamp:new Date().toISOString(),devices:o,fallback:!0,disabled:!0}}async function no(){console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC2\xA7 Testando conex\xC3\u0192\xC2\xA3o com Hubitat...");try{const e=await fetch(`${q}?devices=231`);console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC2\xA7 Status da resposta:",e.status),console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC2\xA7 Headers da resposta:",Object.fromEntries(e.headers.entries()));const o=await e.text();if(console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC2\xA7 Conte\xC3\u0192\xC2\xBAdo da resposta:",o.substring(0,300)),e.ok)try{const t=JSON.parse(o);return console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Conex\xC3\u0192\xC2\xA3o OK - Dados:",t),!0}catch(t){return console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Resposta n\xC3\u0192\xC2\xA3o \xC3\u0192\xC2\xA9 JSON v\xC3\u0192\xC2\xA1lido:",t),!1}else return console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Erro HTTP:",e.status,e.statusText),!1}catch(e){return console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Erro na conex\xC3\u0192\xC2\xA3o:",e),!1}}function jo(e,o,t){if(to(e)){let n=`${No}/${encodeURIComponent(e)}`;o&&(n+=`/${encodeURIComponent(o)}`,t!=null&&t!==""&&(n+=`/${encodeURIComponent(t)}`));const a=n.includes("?")?"&":"?";return`${n}${a}access_token=${encodeURIComponent(Vo)}`}return`${oo}?device=${e}&command=${encodeURIComponent(o)}${t!==void 0?`&value=${encodeURIComponent(t)}`:""}`}async function b(e,o,t){console.log(`Enviando comando: ${o} para dispositivo ${e}${t!==void 0?` com valor ${t}`:""}`);try{if(M){const n=`${oo}?device=${e}&command=${encodeURIComponent(o)}${t!==void 0?`&value=${encodeURIComponent(t)}`:""}`;try{const a=await fetch(n),s=await a.text();if(s.trim().startsWith("<!DOCTYPE")||s.includes("<html"))throw new Error("Function retornou HTML - fazendo fallback para API direta");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);console.log("Comando enviado com sucesso via proxy");try{return JSON.parse(s)}catch{return null}}catch(a){console.log("Proxy falhou, tentando API direta:",a.message)}}throw new Error("Proxy indispon\xC3\u0192\xC2\xADvel e acesso direto desativado")}catch(n){throw console.error("Erro ao enviar comando para o Hubitat:",n),n}}function Go(e,o,t){if(to(e)){const i={open:"open",stop:"stop",close:"close"}[o];if(!i)throw new Error("A\xE7\xE3o de cortina inv\xE1lida");return b(e,i)}const n=t||"push";let a;String(e)==="39"?(a={open:3,stop:2,close:1},console.log(`\u{1FA9F} Cortina com comandos invertidos (ID ${e}): comando ${o} mapeado para valor ${a[o]}`)):a={open:1,stop:2,close:3};const s=a[o];if(s===void 0)throw new Error("A\xE7\xE3o de cortina inv\xE1lida");return b(e,n,s)}function Wo(e,o){var t,n,a,s;try{const r=((t=e==null?void 0:e.dataset)==null?void 0:t.deviceId)||((a=(n=e.closest("[data-device-id]"))==null?void 0:n.dataset)==null?void 0:a.deviceId),i=((s=e==null?void 0:e.dataset)==null?void 0:s.cmd)||"push";if(!r)return;Go(r,o,i)}catch(r){console.error("Falha ao acionar cortina:",r)}}try{typeof b=="function"&&(b=function(o,t,n){const a=jo(o,t,n),s=a+(a.includes("?")?"&":"?")+`_ts=${Date.now()}`;console.log(`Enviando comando para o Hubitat (no-cors): ${s}`);try{return fetch(s,{mode:"no-cors",cache:"no-store",credentials:"omit",redirect:"follow",referrerPolicy:"no-referrer",keepalive:!0}).then(()=>null).catch(r=>{try{const i=new Image;i.referrerPolicy="no-referrer",i.src=s}catch{}return console.error("Erro ao enviar comando (CORS?):",r),null})}catch{try{const i=new Image;i.referrerPolicy="no-referrer",i.src=s}catch{}return Promise.resolve(null)}})}catch{}const K=5e3,Yo=2e3,je=2e4;let x=K,H=null,W=!1,Y=0,ye=!1;const _=new Map,ie=8e3;function ue(e,o){console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xE2\u20AC\u017E setMasterButtonLoading chamada:",e,"loading:",o),o?(e.classList.add("loading"),e.dataset.loading="true",console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Loading ativado - classes:",e.className)):(e.classList.remove("loading"),e.dataset.loading="false",console.log("\xC3\xA2\xC2\x9D\xC5\u2019 Loading desativado - classes:",e.className))}function Xo(){const e=Date.now();for(const[o,t]of _.entries())e-t>ie&&_.delete(o)}function Ko(e){if(!W)return;const o=Math.max(e,500);H!==null&&clearTimeout(H),H=setTimeout(function(){H=null,Oe()},o),A(()=>["scheduleNextPollingRun",o])}function ao(){if(!W){if(!M){A(()=>["Polling desativado em ambiente de desenvolvimento"]);return}W=!0,Y=0,x=K,Oe(),console.log("Polling iniciado - intervalo base",K/1e3,"segundos")}}function _e(){W&&(W=!1,Y=0,x=K,H!==null&&(clearTimeout(H),H=null),console.log("Polling parado"))}typeof document!="undefined"&&document.addEventListener("visibilitychange",function(){document.hidden?W&&(ye=!0,_e()):ye&&(ye=!1,ao())});async function Oe(e={}){const o=!!(e&&e.skipSchedule);let t=!1,n=!1;try{if(Xo(),!M){A(()=>["Polling skipped (dev mode)"]);return}const a=P.join(","),s=`${q}?devices=${a}`;A(()=>["pollingRequest",{interval:x,url:s}]);const r=await fetch(s,{cache:"no-store"});if(!r.ok)throw new Error(`Polling failed: ${r.status}`);const i=await r.json();let l=i.devices;if(!l&&Array.isArray(i.data)&&(l={},i.data.forEach(u=>{if(!u||!u.id)return;let h="off";if(Array.isArray(u.attributes)){const p=u.attributes.find(y=>y.name==="switch");h=(p==null?void 0:p.currentValue)||(p==null?void 0:p.value)||"off"}else if(u.attributes&&typeof u.attributes=="object")if(u.attributes.switch!==void 0)h=u.attributes.switch;else{A(()=>["Polling skip device (no switch)",u.id]);return}l[u.id]={state:h,success:!0},u.attributes&&u.attributes.volume!==void 0&&(l[u.id].volume=u.attributes.volume)})),!l){A(()=>["Polling response sem devices",i]);return}Object.entries(l).forEach(([u,h])=>{if(h)if(h.success){const p=k(u),y=h.state;p!==y&&(t=!0),G(u,y),$(u,y),String(u)==="15"&&h.volume!==void 0&&Lo(h.volume)}else console.warn(`Falha no device ${u}:`,h.error)}),se(),typeof updateMasterLightToggleState=="function"&&updateMasterLightToggleState()}catch(a){if(n=!0,console.error("Erro no polling:",a),a.message.includes("JSON.parse")||a.message.includes("unexpected character")){console.error("PARANDO POLLING - Cloudflare Functions n\xE3o funcionam"),_e();return}}finally{!o&&W&&(n?(Y+=1,x=Math.min(Math.round(x*1.5)||K,je)):t?(Y=0,x=K):(Y=0,x=Math.min(x+Yo,je)),A(()=>["pollingNextInterval",{encounteredError:n,hasStateChanges:t,nextInterval:x,failureCount:Y}]),Ko(x))}}function $(e,o,t=!1){if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",()=>$(e,o,t));return}if(!t){const a=_.get(e);if(a&&Date.now()-a<ie)return}const n=document.querySelectorAll(`[data-device-id="${e}"]`);console.log(`\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC2\xA7 updateDeviceUI(${e}, ${o}) - Encontrados ${n.length} controles`),n.forEach((a,s)=>{if(console.log(`\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC2\xA7 Controle ${s+1}: classes="${a.className}", currentState="${a.dataset.state}"`),a.classList.contains("room-control")||a.classList.contains("control-card")){const r=a.dataset.state;r!==o||t?(console.log(`\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xE2\u20AC\u017E Atualizando controle ${e}: "${r}" \xC3\xA2\xE2\u20AC\xA0\xE2\u20AC\u2122 "${o}" (force=${t})`),Ze(a,o),G(e,o)):console.log(`\xC3\xA2\xC5\u201C\xE2\u20AC\u0153 Controle ${e} j\xC3\u0192\xC2\xA1 est\xC3\u0192\xC2\xA1 no estado correto: "${o}"`)}else console.log(`\xC3\xA2\xC5\xA1\xC2\xA0\xC3\xAF\xC2\xB8\xC2\x8F Elemento encontrado mas n\xC3\u0192\xC2\xA3o \xC3\u0192\xC2\xA9 room-control nem control-card: ${a.className}`)}),String(e)==="15"&&De(o),se()}function se(e=!1){ge(),U.forEach(function(o){if(!o.isConnected){U.delete(o);return}const t=(o.dataset.deviceIds||"").split(",").map(function(a){return a.trim()}).filter(Boolean);if(t.length===0)return;const n=fe(t)?"on":"off";Re(o,n,e)})}function fe(e){return(e||[]).some(o=>(k(o)||"off")==="on")}function Re(e,o,t=!1){if(!t&&e.dataset.pending==="true"){A(()=>["masterButtonPending",e.dataset.deviceIds]);return}const n=e.querySelector("img");if(!n)return;const a=o==="on"?"images/icons/icon-small-light-on.svg":"images/icons/icon-small-light-off.svg";(n.src||"").includes(a.split("/").pop())||(n.src=a,e.dataset.state=o,A(()=>["masterIconUpdated",o,e.dataset.deviceIds]))}function so(){try{const e=document.getElementById("global-loader");e?(e.classList.remove("hidden"),e.style.display="flex",E(0,"Iniciando carregamento..."),console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xB1 Loader exibido")):console.warn("\xC3\xA2\xC5\xA1\xC2\xA0\xC3\xAF\xC2\xB8\xC2\x8F Elemento loader n\xC3\u0192\xC2\xA3o encontrado")}catch(e){console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Erro ao mostrar loader:",e)}}function Q(){try{const e=()=>{const o=document.getElementById("global-loader");o&&setTimeout(()=>{o.classList.add("hidden"),setTimeout(()=>{o.style.display="none"},500),console.log("Loader escondido")},500)};if(!Xe&&oe){const o=oe;oe=null,o.catch(t=>console.warn("Falha ao pr\xE9-carregar todos os assets",t)).finally(e);return}e()}catch(e){console.error("Erro ao esconder loader:",e)}}function E(e,o){try{const t=document.getElementById("progress-fill"),n=document.getElementById("progress-text"),a=document.querySelector(".loader-text");t&&(t.style.width=e+"%"),n&&(n.textContent=Math.round(e)+"%"),a&&o&&(a.textContent=o),console.log(`\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC5\xA0 Progresso: ${e}% - ${o||"Carregando..."}`)}catch(t){console.warn("\xC3\xA2\xC5\xA1\xC2\xA0\xC3\xAF\xC2\xB8\xC2\x8F Erro ao atualizar progresso:",t)}}async function ro(){if(console.log("\xC3\xB0\xC5\xB8\xC5\u2019\xC2\x8D Iniciando carregamento global de estados..."),console.log("\xC3\xB0\xC5\xB8\xC5\u2019\xC2\x8D ALL_LIGHT_IDS dispon\xC3\u0192\xC2\xADvel:",!!P,"Length:",P?P.length:"undefined"),console.log("\xC3\xB0\xC5\xB8\xC5\u2019\xC2\x8D DEBUG CARREGAMENTO:",{isProduction:M,hostname:location.hostname,isMobile:j,userAgent:navigator.userAgent.substring(0,100)}),console.log("\xC3\xB0\xC5\xB8\xC5\u2019\xC2\x8D Carregamento universal (desktop e mobile id\xC3\u0192\xC2\xAAnticos)"),!M){console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u2122\xC2\xBB MODO DESENVOLVIMENTO ATIVO - carregando do localStorage"),console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u2122\xC2\xBB ISSO PODE SER O PROBLEMA NO MOBILE!"),console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xE2\u20AC\xB9 Dispositivos a carregar:",P.length),E(20,"Modo DEV - Estados salvos...");try{await new Promise(a=>setTimeout(a,500))}catch{console.warn("Promise fallback ativo")}let n=0;return P.forEach((a,s)=>{let r="off";try{r=k(a)||"off",$(a,r,!0),n++}catch(l){console.warn(`\xC3\xA2\xC2\x9D\xC5\u2019 Erro ao processar ${a}:`,l)}const i=20+(s+1)/P.length*80;E(i,`Dispositivo ${s+1}/${P.length}...`)}),console.log(`\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Carregamento completo: ${n}/${P.length} dispositivos`),E(100,"Carregamento conclu\xC3\u0192\xC2\xADdo!"),!0}try{let y=function(d,c){if(c.success)G(d,c.state),$(d,c.state,!0);else{console.warn(`Falha no device ${d}:`,c.error);const f=k(d)||"off";$(d,f,!0)}p++;const m=70+p/h.length*25;E(m,`Aplicando estado ${p}/${h.length}...`)},w=function(d){typeof window!="undefined"&&typeof window.requestIdleCallback=="function"?window.requestIdleCallback(d,{timeout:120}):setTimeout(d,16)},C=function(d){return new Promise(c=>{let m=0;const f=20,g=S=>{const T=S&&typeof S.timeRemaining=="function";let D=0;for(;m<d.length;){const F=d[m++];if(y(F[0],F[1]),D+=1,D>=f||T&&S.timeRemaining()<=4)break}m<d.length?w(g):c()};g()})};var e=y,o=w,t=C;console.log("\xC3\xB0\xC5\xB8\xC5\u2019\xC2\x8D MODO PRODU\xC3\u0192\xE2\u20AC\xA1\xC3\u0192\xC6\u2019O ATIVO - buscando do servidor"),E(10,"Testando conectividade...");try{const d=new AbortController,c=setTimeout(()=>d.abort(),Z.HEALTH_CHECK_TIMEOUT),m=await fetch(q+"?health=1",{method:"GET",signal:d.signal,mode:"cors"});clearTimeout(c),console.log("\xC3\xB0\xC5\xB8\xC2\x8F\xC2\xA5 Health check:",m.ok?"OK":"FAIL")}catch(d){console.warn("\xC3\xA2\xC5\xA1\xC2\xA0\xC3\xAF\xC2\xB8\xC2\x8F Health check falhou, continuando mesmo assim:",d.message)}E(20,"Conectando com servidor...");const n=P.join(",");console.log(`\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xA1 Buscando estados de ${P.length} dispositivos no servidor...`),console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xA1 URL ser\xC3\u0192\xC2\xA1:",`${q}?devices=${n}`),E(30,"Enviando solicita\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xA3o...");const a=async(d,c,m=Z.MAX_RETRY_ATTEMPTS)=>{for(let f=1;f<=m;f++)try{console.log(`\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xA1 Tentativa ${f}/${m} para ${d}`),E(30+(f-1)*5,`Tentativa ${f}/${m}...`);let g,S;const T=Z.FETCH_TIMEOUT_PER_ATTEMPT;typeof AbortController!="undefined"&&(g=new AbortController,S=setTimeout(()=>{console.warn(`\xC3\xA2\xC2\x8F\xC2\xB0 Timeout de ${T/1e3}s atingido na tentativa ${f}`),g.abort()},T),c.signal=g.signal);const D=await fetch(d,c);if(S&&clearTimeout(S),console.log(`\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xA1 Tentativa ${f} - Status: ${D.status}`),!D.ok)throw new Error(`HTTP ${D.status}: ${D.statusText}`);return D}catch(g){if(console.warn(`\xC3\xA2\xC2\x9D\xC5\u2019 Tentativa ${f} falhou:`,g.message),f===m)throw new Error(`Falha ap\xC3\u0192\xC2\xB3s ${m} tentativas: ${g.message}`);const S=Math.min(Z.RETRY_DELAY_BASE*Math.pow(2,f-1),Z.RETRY_DELAY_MAX);console.log(`\xC3\xA2\xC2\x8F\xC2\xB3 Aguardando ${S}ms antes da pr\xC3\u0192\xC2\xB3xima tentativa...`),E(30+f*5,`Reagendando em ${S/1e3}s...`),await new Promise(T=>setTimeout(T,S))}},s={method:"GET",cache:"no-cache",mode:"cors"},r=`${q}?devices=${n}`;console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xA1 Fazendo fetch com retry para:",r);const i=await a(r,s);if(console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xA1 Resposta recebida, status:",i.status),E(50,"Recebendo dados..."),!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);let l,u="";try{if(console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xA1 Parseando resposta JSON..."),u=await i.text(),console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xA1 Resposta recebida (texto):",u.substring(0,500)),!u)throw new Error("Resposta vazia do servidor");if(u.trim().startsWith("<!DOCTYPE html")||u.trim().startsWith("<html")){console.error("\xC3\xA2\xC2\x9D\xC5\u2019 CR\xC3\u0192\xC2\x8DTICO: Cloudflare Functions n\xC3\u0192\xC2\xA3o est\xC3\u0192\xC2\xA3o funcionando!"),console.error("\xC3\xA2\xC2\x9D\xC5\u2019 O servidor est\xC3\u0192\xC2\xA1 retornando HTML em vez de executar as Functions."),console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Implementando fallback autom\xC3\u0192\xC2\xA1tico para API direta do Hubitat..."),console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xE2\u20AC\u017E Tentando API direta do Hubitat como fallback..."),E(60,"Usando API direta como fallback...");try{const d=await Ho(P);console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Fallback bem-sucedido:",d);const c=Object.entries(d.devices);let m=0;return c.forEach(([f,g])=>{if(g.success)G(f,g.state),$(f,g.state,!0),console.log(`\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Device ${f}: ${g.state} (direto)`);else{const T=k(f)||"off";$(f,T,!0),console.log(`\xC3\xA2\xC5\xA1\xC2\xA0\xC3\xAF\xC2\xB8\xC2\x8F Device ${f}: usando estado salvo "${T}"`)}m++;const S=60+m/c.length*35;E(S,`Processando ${m}/${c.length}...`)}),E(100,"Carregamento via API direta conclu\xC3\u0192\xC2\xADdo!"),setTimeout(()=>{se(),console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xE2\u20AC\u017E Bot\xC3\u0192\xC2\xB5es master atualizados ap\xC3\u0192\xC2\xB3s fallback")},100),console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Fallback autom\xC3\u0192\xC2\xA1tico conclu\xC3\u0192\xC2\xADdo com sucesso"),!0}catch(d){throw console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Fallback tamb\xC3\u0192\xC2\xA9m falhou:",d),console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xA6 Usando estados salvos como \xC3\u0192\xC2\xBAltimo recurso..."),P.forEach(c=>{const m=k(c)||"off";$(c,m,!0)}),new Error("Functions n\xC3\u0192\xC2\xA3o funcionam e API direta tamb\xC3\u0192\xC2\xA9m falhou - usando estados salvos")}}l=JSON.parse(u),console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xA1 JSON parseado com sucesso")}catch(d){throw console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Erro ao parsear JSON:",d),console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Conte\xC3\u0192\xC2\xBAdo da resposta que falhou:",u==null?void 0:u.substring(0,200)),new Error(`Resposta inv\xC3\u0192\xC2\xA1lida do servidor: ${d.message}`)}if(console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xA1 Estados recebidos:",l),!l.devices)try{if(Array.isArray(l.data)){console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xE2\u20AC\u017E Normalizando",l.data.length,"dispositivos do formato novo...");const d={};l.data.forEach((c,m)=>{if(!c||!c.id){console.warn(`\xC3\xA2\xC5\xA1\xC2\xA0\xC3\xAF\xC2\xB8\xC2\x8F Dispositivo ${m} inv\xC3\u0192\xC2\xA1lido:`,c);return}let f="off";if(Array.isArray(c.attributes)){const g=c.attributes.find(S=>S.name==="switch");g&&(f=(g==null?void 0:g.currentValue)||(g==null?void 0:g.value)||"off")}else if(c.attributes&&typeof c.attributes=="object")if(c.attributes.switch!==void 0)f=c.attributes.switch,console.log(`\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xE2\u20AC\xB9 Device ${c.id}: switch=${f}`);else{console.log(`\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xCB\u0153 Device ${c.id}: n\xC3\u0192\xC2\xA3o \xC3\u0192\xC2\xA9 l\xC3\u0192\xC2\xA2mpada (sem atributo 'switch'), pulando...`);return}else console.warn(`\xC3\xA2\xC5\xA1\xC2\xA0\xC3\xAF\xC2\xB8\xC2\x8F Device ${c.id}: attributes inv\xC3\u0192\xC2\xA1lido:`,c.attributes);d[c.id]={state:f,success:!0}}),l.devices=d,console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xE2\u20AC\u017E Resposta normalizada para formato devices (",Object.keys(d).length,"dispositivos )"),console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC2\x8D Estados finais mapeados:",d)}else throw new Error("Formato de resposta inesperado: falta campo devices e data[]")}catch(d){throw console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Falha ao normalizar resposta:",d),d}E(70,"Processando estados...");const h=Object.entries(l.devices||{});console.log(`Processando ${h.length} dispositivos...`);let p=0;return await C(h),E(95,"Finalizando sincroniza\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xA3o..."),setTimeout(()=>{se(),console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xE2\u20AC\u017E Bot\xC3\u0192\xC2\xB5es master atualizados ap\xC3\u0192\xC2\xB3s carregamento global")},100),E(100,"Estados carregados com sucesso!"),console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Carregamento global conclu\xC3\u0192\xC2\xADdo com sucesso"),!0}catch(n){console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Erro no carregamento global:",n);try{console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC2\xA7 Executando diagn\xC3\u0192\xC2\xB3stico da conex\xC3\u0192\xC2\xA3o..."),await no()||z("Falha na conex\xC3\u0192\xC2\xA3o com Hubitat. Verifique se as configura\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xB5es foram alteradas no painel do Cloudflare.")}catch(s){console.error("Erro no diagn\xC3\u0192\xC2\xB3stico:",s)}return n.name==="AbortError"?(console.warn("\xC3\xA2\xC2\x8F\xC2\xB1\xC3\xAF\xC2\xB8\xC2\x8F Timeout ap\xC3\u0192\xC2\xB3s m\xC3\u0192\xC2\xBAltiplas tentativas"),E(60,"Timeout - usando backup..."),z("Timeout na conex\xC3\u0192\xC2\xA3o. Verifique sua internet e tente novamente.")):n.message.includes("Falha ap\xC3\u0192\xC2\xB3s")?(console.warn("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xE2\u20AC\u017E M\xC3\u0192\xC2\xBAltiplas tentativas falharam"),E(60,"Falhas m\xC3\u0192\xC2\xBAltiplas - modo backup..."),z("Servidor temporariamente indispon\xC3\u0192\xC2\xADvel. Usando dados salvos.")):n.name==="TypeError"&&n.message.includes("fetch")?(console.warn("\xC3\xB0\xC5\xB8\xC5\u2019\xC2\x90 Problema de conectividade de rede"),E(60,"Sem rede - modo offline..."),z("Sem conex\xC3\u0192\xC2\xA3o com a internet. Modo offline ativado.")):n.message.includes("HTTP 5")?(console.warn("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC2\xA5 Erro no servidor (5xx)"),E(60,"Erro servidor - backup..."),z("Problema no servidor. Usando \xC3\u0192\xC2\xBAltimos dados conhecidos.")):(console.warn("\xC3\xA2\xC2\x9D\xC5\u2019 Erro desconhecido no carregamento:",n.message),E(60,"Erro geral - usando backup..."),z("Erro no carregamento. Usando dados salvos localmente.")),P.forEach((s,r)=>{const i=k(s)||"off";$(s,i,!0);const l=60+(r+1)/P.length*35;E(l,`Carregando backup ${r+1}/${P.length}...`)}),E(100,"Carregamento conclu\xC3\u0192\xC2\xADdo (modo offline)"),!1}}function Jo(){const e=[],o=[];typeof fetch=="undefined"&&e.push("Fetch API n\xC3\u0192\xC2\xA3o suportada"),typeof Promise=="undefined"&&e.push("Promises n\xC3\u0192\xC2\xA3o suportadas"),typeof MutationObserver=="undefined"&&o.push("MutationObserver n\xC3\u0192\xC2\xA3o suportado (usar fallback)"),typeof AbortController=="undefined"&&o.push("AbortController n\xC3\u0192\xC2\xA3o suportado (sem timeout)"),typeof localStorage=="undefined"&&o.push("LocalStorage n\xC3\u0192\xC2\xA3o suportado (sem persist\xC3\u0192\xC2\xAAncia)");try{const t="__test_ls__";localStorage.setItem(t,"test"),localStorage.removeItem(t)}catch{o.push("LocalStorage bloqueado (modo privado?)")}return o.length>0&&console.warn("\xC3\xA2\xC5\xA1\xC2\xA0\xC3\xAF\xC2\xB8\xC2\x8F Avisos de compatibilidade:",o),e.length>0?(console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Problemas cr\xC3\u0192\xC2\xADticos detectados:",e),!1):(console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Compatibilidade mobile verificada"),!0)}function Zo(){const e=document.getElementById("spa-root")||document.body;if(Qe({root:e,force:!0}),ge(),Ie(!0),typeof MutationObserver=="undefined"){console.warn("MutationObserver indisponivel - usando fallback de sincronizacao periodica"),N&&clearInterval(N),N=setInterval(function(){re()},8e3);return}try{N&&(clearInterval(N),N=null),le&&le.disconnect(),le=new MutationObserver(function(o){let t=!1;o.forEach(function(n){n.removedNodes.forEach(function(a){_o(a)&&(t=!0)}),n.addedNodes.forEach(function(a){Mo(a)&&(t=!0)})}),t&&Ie(!0)}),le.observe(e,{childList:!0,subtree:!0})}catch(o){console.error("Erro ao configurar MutationObserver:",o),console.warn("Usando fallback de sincronizacao periodica."),N&&clearInterval(N),N=setInterval(function(){re()},8e3)}}function re(e=!1){ge(),A(()=>["syncAllVisibleControls",{devices:V.size,force:e}]);let o=0;V.forEach(function(t,n){if(!t||t.size===0){V.delete(n);return}const a=k(n);a!=null&&(t.forEach(function(r){if(!r.isConnected){t.delete(r);return}(r.dataset.state!==a||e)&&(Ze(r,a),o+=1)}),t.size===0&&V.delete(n))}),U.forEach(function(t){if(!t.isConnected){U.delete(t);return}const n=(t.dataset.deviceIds||"").split(",").map(function(s){return s.trim()}).filter(Boolean);if(n.length===0)return;const a=fe(n)?"on":"off";Re(t,a,e)}),A(()=>["syncAllVisibleControls:updated",o])}window.debugEletrize={forcePolling:Oe,reloadStates:ro,syncControls:re,showLoader:so,hideLoader:Q,checkDevice:e=>{const o=k(e);console.log(`Device ${e}: stored=${o}`)},checkAllDevices:()=>{console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xE2\u20AC\xB9 Estados de todos os dispositivos:"),P.forEach(e=>{const o=k(e);console.log(`  ${e}: ${o}`)})},testSetState:(e,o)=>{console.log(`\xC3\xB0\xC5\xB8\xC2\xA7\xC2\xAA Testando setState(${e}, ${o})`),G(e,o),$(e,o,!0),console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Teste completo")},clearAllStates:()=>{console.log("Limpando todos os estados salvos..."),P.forEach(e=>{ee.delete(e);try{localStorage.removeItem(Le(e))}catch(o){A(()=>["Falha ao limpar estado local",e,o])}}),console.log("Estados limpos")},checkProtectedCommands:()=>{if(console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\xBA\xC2\xA1\xC3\xAF\xC2\xB8\xC2\x8F Comandos protegidos:"),_.size===0){console.log("  \xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Nenhum comando protegido");return}const e=Date.now();_.forEach((o,t)=>{const n=Math.max(0,ie-(e-o)),a=n>0?"\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xE2\u20AC\u2122 ATIVO":"\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xE2\u20AC\u0153 EXPIRADO";console.log(`  ${a} ${t}: ${Math.ceil(n/1e3)}s restantes`)})},testMasterLoading:()=>{console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xE2\u20AC\u017E Testando loading nos bot\xC3\u0192\xC2\xB5es master...");const e=document.querySelectorAll(".room-master-btn"),o=document.querySelectorAll(".scene-control-card");console.log("Bot\xC3\u0192\xC2\xB5es master encontrados:",e.length),console.log("Bot\xC3\u0192\xC2\xB5es de cen\xC3\u0192\xC2\xA1rio encontrados:",o.length),e.forEach((t,n)=>{console.log(`Testando bot\xC3\u0192\xC2\xA3o master ${n+1}:`,t),setTimeout(()=>{ue(t,!0),setTimeout(()=>{ue(t,!1)},3e3)},n*200)}),o.forEach((t,n)=>{setTimeout(()=>{ue(t,!0),setTimeout(()=>{ue(t,!1)},3e3)},(e.length+n)*200)})},checkMasterButtons:()=>{console.log("\xC3\xB0\xC5\xB8\xC2\x8F\xC2\xA0 Status dos bot\xC3\u0192\xC2\xB5es master:"),document.querySelectorAll(".room-master-btn").forEach((e,o)=>{const t=(e.dataset.deviceIds||"").split(",").filter(Boolean),n=e.dataset.route||"unknown",a=e.dataset.pending==="true",s=e.dataset.state||"unknown",r=fe(t)?"on":"off",i=s===r;console.log(`  ${o+1}. ${n}: ${s} (calc: ${r}) ${i?"\xC3\xA2\xC5\u201C\xE2\u20AC\xA6":"\xC3\xA2\xC2\x9D\xC5\u2019"} ${a?"\xC3\xA2\xC2\x8F\xC2\xB3":"\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xE2\u20AC\u0153"}`)})},fixMasterButtons:()=>{console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC2\xA7 Corrigindo todos os bot\xC3\u0192\xC2\xB5es master..."),document.querySelectorAll(".room-master-btn").forEach(e=>{e.dataset.pending="false";const o=(e.dataset.deviceIds||"").split(",").filter(Boolean),t=fe(o)?"on":"off";Re(e,t,!0)}),console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Bot\xC3\u0192\xC2\xB5es master corrigidos!")},mobileInfo:()=>{console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\xB1 Informa\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xB5es do dispositivo m\xC3\u0192\xC2\xB3vel:"),console.log("  isMobile:",j),console.log("  isIOS:",eo),console.log("  isProduction:",M),console.log("  User Agent:",navigator.userAgent),console.log("  App Version:",ve);try{console.log("  \xC3\u0192\xC5\xA1ltima carga:",new Date(parseInt(localStorage.getItem("last_mobile_load")||"0"))),console.log("  Vers\xC3\u0192\xC2\xA3o cache:",localStorage.getItem("app_version"))}catch{console.log("  localStorage indispon\xC3\u0192\xC2\xADvel")}},clearMobileCache:()=>{console.log("\xC3\xB0\xC5\xB8\xC2\xA7\xC2\xB9 Limpando cache mobile...");try{localStorage.removeItem("app_version"),localStorage.removeItem("last_mobile_load"),localStorage.removeItem("app_cache_version"),sessionStorage.clear(),console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Cache mobile limpo! Recarregue a p\xC3\u0192\xC2\xA1gina.")}catch(e){console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Erro ao limpar cache:",e)}},forceMobileReload:()=>{console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xE2\u20AC\u017E For\xC3\u0192\xC2\xA7ando recarga mobile com limpeza de cache...");try{localStorage.clear(),sessionStorage.clear()}catch{}setTimeout(()=>{window.location.reload(!0)},1e3)},checkMobileCache:()=>{console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC2\x8D Status do cache mobile:");try{const e=localStorage.getItem("app_version"),o=localStorage.getItem("last_mobile_load"),t=new Date().getTime();if(console.log("  App Version atual:",ve),console.log("  Vers\xC3\u0192\xC2\xA3o em cache:",e),console.log("  Cache v\xC3\u0192\xC2\xA1lido:",e===ve),o){const n=Math.floor((t-parseInt(o))/6e4);console.log("  Idade do cache:",n,"minutos"),console.log("  Cache expirado:",n>60)}else console.log("  Primeira carga detectada")}catch(e){console.error("  Erro na verifica\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xA3o:",e)}console.log("  Screen:",`${screen.width}x${screen.height}`),console.log("  Viewport:",`${window.innerWidth}x${window.innerHeight}`),console.log("  Connection:",navigator.connection?`${navigator.connection.effectiveType} (${navigator.connection.downlink}Mbps)`:"N\xC3\u0192\xC2\xA3o dispon\xC3\u0192\xC2\xADvel"),Jo()},testMobileApi:async()=>{console.log("\xC3\xB0\xC5\xB8\xC2\xA7\xC2\xAA Testando APIs para mobile...");try{const e=M?`${q}?devices=366`:"#test",o={method:"GET",cache:"no-cache"};if(typeof AbortController!="undefined"){const n=new AbortController;setTimeout(()=>n.abort(),5e3),o.signal=n.signal}const t=await fetch(e,o);console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Fetch test:",t.status,t.statusText)}catch(e){console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Fetch test failed:",e)}}};function $e(){console.log("\xC3\xB0\xC5\xB8\xC5\xBD\xC2\xB5 Buscando metadados do Denon AVR via Hubitat Cloud..."),fetch(`${q}?full=1`).then(async e=>{if(!e.ok){const o=await e.text().catch(()=>"<no body>");throw new Error(`HTTP error! status: ${e.status} - ${o}`)}try{return await e.json()}catch{const t=await e.text().catch(()=>"<non-readable body>");throw new Error(`Invalid JSON response from polling: ${t}`)}}).then(e=>{console.log("\xC3\xB0\xC5\xB8\xC5\xBD\xC2\xB5 Resposta completa do Hubitat:",e);const o=Array.isArray(e)?e:e.devices||[],t="29";let n=o.find(a=>String(a.id)===t||a.id===parseInt(t,10));if(n||(n=o.find(a=>{const s=String(a.name||a.label||"").toLowerCase();return s.includes("denon")||s.includes("receiver")||s.includes("av")}),n&&console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC5\xBD Denon metadata device encontrado por name/label:",n)),n){console.log("Denon encontrado:",n);const a=Ee(n);a&&De(a),console.log("\xC3\xB0\xC5\xB8\xC5\xBD\xC2\xB5 Atributos do Denon:",n.attributes);let s="Desconhecido",r="Sem t\xC3\u0192\xC2\xADtulo",i="\xC3\u0192\xC2\x81lbum desconhecido",l=null,u=null,h=null,p=null;if(Array.isArray(n.attributes)){const w=n.attributes.find(g=>g.name==="artist"||g.name==="trackArtist"),C=n.attributes.find(g=>g.name==="trackDescription"||g.name==="track"),d=n.attributes.find(g=>g.name==="albumName"||g.name==="album"),c=n.attributes.find(g=>g.name==="albumArtUrl"||g.name==="albumArtURI"),m=n.attributes.find(g=>{const S=String((g==null?void 0:g.name)||"").toLowerCase();return S==="status"||S==="playbackstatus"||S==="playerstatus"||S==="transportstate"}),f=n.attributes.find(g=>g.name==="trackData"||g.name==="trackdata");s=(w==null?void 0:w.currentValue)||(w==null?void 0:w.value)||s,r=(C==null?void 0:C.currentValue)||(C==null?void 0:C.value)||r,i=(d==null?void 0:d.currentValue)||(d==null?void 0:d.value)||i,l=(c==null?void 0:c.currentValue)||(c==null?void 0:c.value)||l,u=(m==null?void 0:m.currentValue)||(m==null?void 0:m.value)||u,h=(f==null?void 0:f.currentValue)||(f==null?void 0:f.value)||h}else if(n.attributes&&typeof n.attributes=="object"){if(s=n.attributes.artist||s,r=n.attributes.track||r,i=n.attributes.album||i,u=n.attributes.status||n.attributes.playbackStatus||n.attributes.playerStatus||n.attributes.transportState||u,h=n.attributes.trackData||h,n.attributes.albumArt&&typeof n.attributes.albumArt=="string"){const w=n.attributes.albumArt.match(/src=['"]([^'"]+)['"]/);l=w?w[1]:null}if(!l&&n.attributes.trackData)try{const w=typeof n.attributes.trackData=="string"?JSON.parse(n.attributes.trackData):n.attributes.trackData;p=w,l=w.image_url||l}catch(w){console.warn("\xC3\xA2\xC5\xA1\xC2\xA0\xC3\xAF\xC2\xB8\xC2\x8F Erro ao parsear trackData:",w)}}if(!p&&h)try{p=typeof h=="string"?JSON.parse(h):h}catch(w){console.warn("\xC3\xA2\xC5\xA1\xC2\xA0\xC3\xAF\xC2\xB8\xC2\x8F Erro ao parsear trackData (raw):",w)}!l&&p&&typeof p.image_url=="string"&&(l=p.image_url);let y=He(u);if(y===null&&p){const w=p.play_state||p.player_state||p.state||p.status||p.transport_state;y=He(w)}y!==null&&(window.musicPlayerUI.currentPlaying=y,window.musicPlayerUI&&typeof window.musicPlayerUI.setPlaying=="function"&&window.musicPlayerUI.setPlaying(y)),console.log("\xC3\xB0\xC5\xB8\xC5\xBD\xC2\xB5 Metadados extra\xC3\u0192\xC2\xADdos:",{artist:s,track:r,album:i,albumArt:l}),s=X(s),r=X(r),i=X(i),Qo(s,r,i,l)}else console.log("\xC3\xA2\xC5\xA1\xC2\xA0\xC3\xAF\xC2\xB8\xC2\x8F Denon AVR (ID 29) (metadados) n\xC3\u0192\xC2\xA3o encontrado nos dados"),console.log("Dispositivos dispon\xC3\u0192\xC2\xADveis:",o.map(a=>({id:a.id,name:a.name||a.label})))}).catch(e=>{console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Erro ao buscar metadados do Denon:",e),fetch(`${q}?full=1`).then(o=>o.text()).then(o=>console.log("Raw polling response (debug):",o)).catch(o=>console.warn("N\xC3\u0192\xC2\xA3o foi poss\xC3\u0192\xC2\xADvel obter resposta bruta de /polling:",o))})}function Qo(e,o,t,n){e=X(e),o=X(o),t=X(t);const a=I("#music-artist"),s=I("#music-track"),r=I(".music-album-img"),i=document.querySelector(".page.active");a&&(a.textContent=e),i&&i.querySelectorAll(".music-artist-sync").forEach(l=>l.textContent=e),s&&(s.textContent=o),i&&i.querySelectorAll(".music-track-sync").forEach(l=>l.textContent=o),ke(),r&&(n&&n!=="null"&&n!==""?(r.src=n,r.onerror=function(){this.src="images/Images/photo-varanda.jpg"}):r.src="images/Images/photo-varanda.jpg"),console.log(`\xC3\xB0\xC5\xB8\xC5\xBD\xC2\xB5 UI atualizada: "${o}" por ${e} (${t})`)}let de=null;function io(){Te(),console.log("\xC3\xB0\xC5\xB8\xC5\xBD\xC2\xB5 Iniciando polling de metadados a cada 3 segundos"),de=setInterval(()=>{Ae()?$e():Te()},3e3)}function Te(){de&&(clearInterval(de),de=null,console.log("\xC3\xB0\xC5\xB8\xC5\xBD\xC2\xB5 Polling de metadados parado"))}let Ge=!1;function ke(){et();const e=document.querySelector(".page.active");if(!e)return;e.querySelectorAll(".music-track-marquee__text:not(.music-track-marquee__text--clone)").forEach(t=>{const n=t.closest(".music-track-marquee");if(!n)return;const a=n.querySelector(".music-track-marquee__inner");if(!a)return;const s=n.querySelector(".music-track-marquee__text--clone");s&&(s.textContent=t.textContent||""),n.classList.remove("music-track-marquee--active"),n.style.removeProperty("--music-track-marquee-duration"),requestAnimationFrame(()=>{const r=n.clientWidth,i=a.scrollWidth,l=i>r+2;if(n.classList.toggle("music-track-marquee--active",l),l){const h=Math.min(24,Math.max(10,i/80));n.style.setProperty("--music-track-marquee-duration",`${h}s`)}})})}function et(){if(Ge)return;const e=()=>ke();window.addEventListener("resize",e),window.addEventListener("orientationchange",e),Ge=!0}function co(){if(!Ae()){console.log(" N\xE3o est\xE1 em p\xE1gina de m\xFAsica, ignorando initMusicPlayerUI");return}const e=I("#music-play-toggle"),o=e?e.querySelector(".music-play-toggle__icon--play"):null,t=e?e.querySelector(".music-play-toggle__icon--pause"):null,n=I("#music-next"),a=I("#music-prev"),s=I("#music-mute"),r=I("#music-volume-slider"),i=I(".music-volume-section"),l=I(".volume-icon-unmuted"),u=I(".volume-icon-muted"),h=I("#music-master-on"),p=I("#music-master-off"),y=I(".music-player-inner");console.log("\xC3\xB0\xC5\xB8\xC5\xBD\xC2\xB5 Inicializando player de m\xC3\u0192\xC2\xBAsica...",{playToggleBtn:e,masterOnBtn:h,masterOffBtn:p}),window.musicPlayerUI=window.musicPlayerUI||{};const w=typeof window.musicPlayerUI.currentPowerState=="string"?window.musicPlayerUI.currentPowerState:"on";if(!e||!n||!a){console.warn("\xC3\xA2\xC5\xA1\xC2\xA0\xC3\xAF\xC2\xB8\xC2\x8F Bot\xC3\u0192\xC2\xB5es de controle n\xC3\u0192\xC2\xA3o encontrados");return}let C=!1,d=50,c=!1,m=!1,f=w==="on";function g(v){m=!!v,e.setAttribute("aria-pressed",m?"true":"false"),e.classList.toggle("is-playing",m),o&&(o.style.display=m?"none":"block"),t&&(t.style.display=m?"block":"none"),e.setAttribute("aria-label",m?"Pausar":"Tocar"),window.musicPlayerUI.currentPlaying=m}function S(v){C=v,s.setAttribute("aria-pressed",v?"true":"false"),i.setAttribute("data-muted",v?"true":"false"),l&&u&&(l.style.display=v?"none":"block",u.style.display=v?"block":"none"),v?(d=parseInt(r.value),r.value=0,console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xE2\u20AC\xA1 Volume mutado. Volume anterior:",d),typeof ce=="function"&&ce()):(r.value=d,console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC5\xA0 Volume desmutado. Volume restaurado:",d),typeof ce=="function"&&ce())}let T="15",D="29";try{const v=I(".music-player-card"),R=I("#music-mute")||I("#music-volume-slider")||I("#music-master-on")||I("#music-master-off");v&&v.dataset&&v.dataset.metadataDeviceId&&(D=String(v.dataset.metadataDeviceId)),R&&R.dataset&&R.dataset.deviceId&&(T=String(R.dataset.deviceId))}catch(v){console.warn("N\xC3\u0192\xC2\xA3o foi poss\xC3\u0192\xC2\xADvel ler overrides de IDs de Denon via data-*:",v)}if(e.addEventListener("click",()=>{const v=m?"pause":"play";console.log("\xC3\xB0\xC5\xB8\xC5\xBD\xC2\xB5 Toggle play/pause -> enviando comando",v,"para device",D),b(D,v).then(()=>{console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Comando "+v+" enviado com sucesso"),g(!m)}).catch(R=>console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Erro ao enviar comando "+v+":",R))}),n.addEventListener("click",()=>{console.log("\xC3\xA2\xC2\x8F\xC2\xAD\xC3\xAF\xC2\xB8\xC2\x8F Next clicked - enviando comando para device",D),b(D,"nextTrack").then(()=>console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Comando nextTrack enviado com sucesso")).catch(v=>console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Erro ao enviar comando nextTrack:",v))}),a.addEventListener("click",()=>{console.log("\xC3\xA2\xC2\x8F\xC2\xAE\xC3\xAF\xC2\xB8\xC2\x8F Previous clicked - enviando comando para device",D),b(D,"previousTrack").then(()=>console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Comando previousTrack enviado com sucesso")).catch(v=>console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Erro ao enviar comando previousTrack:",v))}),window.musicPlayerUI.setPlaying=g,window.musicPlayerUI.isPlaying=()=>m,s&&r){let v=function(){const O=parseInt(r.value),L=O/100*100;r.style.setProperty("--volume-percent",L+"%"),console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC5\xA0 Volume ajustado para:",O,"% -",L+"%")};var ce=v;s.addEventListener("click",()=>{const O=!C,L=O?"mute":"unmute";console.log(`\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xE2\u20AC\xA1 Mute button clicked - enviando comando "${L}" para device ${T}`),b(T,L).then(()=>{console.log(`\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Comando ${L} enviado com sucesso`),S(O)}).catch(pe=>console.error(`\xC3\xA2\xC2\x9D\xC5\u2019 Erro ao enviar comando ${L}:`,pe))}),r.addEventListener("input",O=>{v()}),r.addEventListener("change",O=>{v();const L=O.target.value;console.log("\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC5\xA0 Volume finalizado em:",L)});const R=I("#music-volume-slider");R&&(R.addEventListener("input",O=>{const L=parseInt(O.target.value);R.style.setProperty("--volume-percent",L/100*100+"%")}),R.addEventListener("change",O=>{const L=O.target.value;console.log(`\xC3\xB0\xC5\xB8\xE2\u20AC\x9D\xC5\xA0 Music slider changed -> sending setVolume ${L} to Denon (${T})`),_.set(T,Date.now()),b(T,"setVolume",L).then(()=>console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 setVolume sent to Denon via music slider")).catch(pe=>console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Error sending setVolume from music slider:",pe))})),r.style.pointerEvents="auto",v(),console.log("\xC3\xB0\xC5\xB8\xC5\xBD\xC2\xB5 Slider de volume configurado:",r)}else console.warn("\xC3\xA2\xC5\xA1\xC2\xA0\xC3\xAF\xC2\xB8\xC2\x8F Bot\xC3\u0192\xC2\xA3o mute ou slider n\xC3\u0192\xC2\xA3o encontrados");function F(v){f=v,window.musicPlayerUI.currentPowerState=v?"on":"off",v?(h.classList.add("music-master-btn--active"),h.setAttribute("aria-pressed","true"),p.classList.remove("music-master-btn--active"),p.setAttribute("aria-pressed","false"),y.classList.remove("power-off"),console.log("\xC3\xA2\xC5\xA1\xC2\xA1 Player ligado"),S(c)):(p.classList.add("music-master-btn--active"),p.setAttribute("aria-pressed","true"),h.classList.remove("music-master-btn--active"),h.setAttribute("aria-pressed","false"),y.classList.add("power-off"),console.log("\xC3\xA2\xC5\xA1\xC2\xAB Player desligado"),c=C,S(!0))}h&&p&&y&&(h.addEventListener("click",()=>{f||(console.log(`Power ON clicked - enviando comando "on" para device ${T}`),_.set(T,Date.now()),b(T,"on").then(()=>{console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Comando on enviado com sucesso"),F(!0)}).catch(v=>console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Erro ao enviar comando on:",v)))}),p.addEventListener("click",()=>{f&&(console.log(`Power OFF clicked - enviando comando "off" para device ${T}`),_.set(T,Date.now()),b(T,"off").then(()=>{console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 Comando off enviado com sucesso"),F(!1)}).catch(v=>console.error("\xC3\xA2\xC2\x9D\xC5\u2019 Erro ao enviar comando off:",v)))})),window.musicPlayerUI.setPower=v=>F(te(v)==="on"),window.musicPlayerUI.isPowerOn=()=>f,g(!!window.musicPlayerUI.currentPlaying),F(w==="on"),$e(),Je(),io(),ke(),console.log("\xC3\xB0\xC5\xB8\xC5\xBD\xC2\xB5 Player de m\xC3\u0192\xC2\xBAsica inicializado")}document.addEventListener("DOMContentLoaded",()=>{setTimeout(co,100)});function me(){try{var e=document.getElementById("global-loader");e&&(e.style.display="none",void 0);var o=0;P.forEach(function(a){try{var s=document.querySelectorAll('[data-device-id="'+a+'"]');s.forEach(function(r){if(r.classList.contains("room-control")){r.dataset.state="off";var i=r.querySelector(".room-control-icon");i&&(i.src="images/icons/icon-small-light-off.svg"),o++}})}catch(r){""+a+r.message}}),""+o;var t=document.querySelectorAll(".room-control"),n=document.querySelectorAll(".room-master-btn");return""+t.length+n.length,!0}catch(a){return""+a.message,!1}}window.onerror=function(e,o,t,n,a){return console.error("\xC3\xB0\xC5\xB8\xC5\xA1\xC2\xA8 ERRO GLOBAL DETECTADO:"),console.error("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\x8D Mensagem:",e),console.error("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\x8D Arquivo:",o),console.error("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\x8D Linha:",t),console.error("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\x8D Coluna:",n),console.error("\xC3\xB0\xC5\xB8\xE2\u20AC\u0153\xC2\x8D Erro:",a),setTimeout(function(){console.log("\xC3\xB0\xC5\xB8\xC5\xA1\xC2\xA8 Tentando recupera\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xA3o autom\xC3\u0192\xC2\xA1tica...");try{me()}catch(s){console.error("\xC3\xB0\xC5\xB8\xE2\u20AC\u2122\xC2\xA5 Falha na recupera\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xA3o:",s)}},1e3),!1};window.addEventListener("unhandledrejection",function(e){console.error("\xC3\xB0\xC5\xB8\xC5\xA1\xC2\xA8 PROMISE REJEITADA:",e.reason),console.error("\xC3\xB0\xC5\xB8\xC5\xA1\xC2\xA8 Promise:",e.promise)});console.log("Script carregado, configurando DOMContentLoaded...");function lo(){console.log("DASHBOARD ELETRIZE INICIALIZANDO"),console.log("Mobile detectado:",j),window.initializationStarted=!0;try{console.log("Iniciando carregamento (comportamento unificado)..."),so();var e=500;console.log("Delay de inicializa\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xA3o: "+e+"ms (universal)"),setTimeout(function(){console.log("Iniciando carregamento principal...");try{ro().then(function(o){console.log("Carregamento global conclu\xC3\u0192\xC2\xADdo, success:",o);var t=800;setTimeout(function(){Q(),Zo();var n=100;if(setTimeout(()=>{console.log("\xC3\xB0\xC5\xB8\xC2\x8F\xC2\xA0 Inicializando controles de c\xC3\u0192\xC2\xB4modos na inicializa\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xA3o..."),Oo(),Ie(!0)},n),M){var a=3e3;console.log("\xC3\xA2\xC5\u201C\xE2\u20AC\xA6 INICIANDO POLLING em "+a/1e3+" segundos (universal)",{isProduction:M,hostname:location.hostname,isMobile:j}),setTimeout(ao,a)}else console.log("\xC3\xA2\xC2\x9D\xC5\u2019 POLLING N\xC3\u0192\xC6\u2019O INICIADO - n\xC3\u0192\xC2\xA3o est\xC3\u0192\xC2\xA1 em produ\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xA3o:",{isProduction:M,hostname:location.hostname,isMobile:j});console.log("Aplica\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xA3o totalmente inicializada!"),window.appFullyInitialized=!0},t)}).catch(function(o){console.error("Erro no carregamento global:",o),""+o.message,Q(),setTimeout(function(){try{me()}catch(t){console.error("Falha total na recupera\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xA3o:",t),E(100,"Erro cr\xC3\u0192\xC2\xADtico - recarregue a p\xC3\u0192\xC2\xA1gina"),setTimeout(function(){Q()},3e3)}},1e3)})}catch(o){console.error("Erro cr\xC3\u0192\xC2\xADtico na inicializa\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xA3o:",o),""+o.message;try{me()}catch(t){console.error("Falha no modo de emerg\xC3\u0192\xC2\xAAncia:",t),E(100,"Erro cr\xC3\u0192\xC2\xADtico - recarregue a p\xC3\u0192\xC2\xA1gina"),setTimeout(Q,3e3)}}},e)}catch(o){console.error("ERRO CRITICO NA INICIALIZACAO PRINCIPAL:",o),""+o.message;try{me()}catch(t){console.error("FALHA TOTAL:",t),""+t.message}}}window.addEventListener("DOMContentLoaded",function(){console.log("DOMContentLoaded executado, chamando initializeApp..."),lo()});setTimeout(function(){window.initializationStarted||(console.log("Fallback: DOMContentLoaded n\xC3\u0192\xC2\xA3o executou, for\xC3\u0192\xC2\xA7ando inicializa\xC3\u0192\xC2\xA7\xC3\u0192\xC2\xA3o..."),lo())},2e3);window.addEventListener("beforeunload",_e);window.testHubitatConnection=no;window.showErrorMessage=z;window.toggleRoomControl=Eo;window.togglePoolControl=bo;window.fireTVMacro=Do;window.htvMacroOn=Co;window.htvMacroOff=To;window.tvMacroOn=Ao;window.tvMacroOff=Po;window.tvCommand=Io;window.curtainAction=Wo;window.spaNavigate=spaNavigate;window.handleMasterCurtainsOpen=handleMasterCurtainsOpen;window.handleMasterCurtainsClose=handleMasterCurtainsClose;})();
